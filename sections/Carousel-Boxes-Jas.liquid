{{- 'toggle-boxes.css' | asset_url | stylesheet_tag -}}
<script src="{{ 'toggle-boxes.js' | asset_url }}" defer="defer"></script>
{%- liquid
  assign section_heading = section.settings.heading
  assign marker_style = section.settings.marker_style
  assign section_description = section.settings.description
  assign columns_desktop = section.settings.columns_desktop
  assign column_spacing = section.settings.column_spacing
  assign mobile_swipe = section.settings.mobile_swipe
  assign image_ratio = section.settings.image_ratio
  assign text_alignment = section.settings.text_alignment

  assign color_bg = section.settings.color_bg
  assign color_heading = section.settings.color_heading
  assign marker_color = section.settings.marker_color
  assign color_text = section.settings.color_text
  assign color_link = section.settings.color_link

  assign disable_top_spacing = section.settings.disable_top_spacing
  assign disable_bottom_spacing = section.settings.disable_bottom_spacing
-%}
<div class="toggle-boxes section-spacing{% if disable_top_spacing %} section-spacing--disable-top{% endif %}{% if disable_bottom_spacing %} section-spacing--disable-bottom{% endif %}">
  <div class="row">
    <div class="small-12 columns">
      {%- render 'section-header', section_heading: section_heading, section_description: section_description, marker_color: marker_color, marker_style: marker_style -%}
    </div>
  </div>
  <div class="toggle-boxes--inner column-spacing--{{ column_spacing }}{% if mobile_swipe %} swipe-on-mobile{% endif %}" style="--toggle-columns: {{ columns_desktop }}; --color-bg: {{ color_bg }}; --color-body: {{ color_text }}; --color-heading: {{ color_heading }}; --color-accent: {{ color_link }};">
    {%- for block in section.blocks -%}
      {%- liquid
        assign ratio = 1
        if image_ratio == 'adapt' and block.settings.image
          assign ratio = block.settings.image.aspect_ratio
        endif
      -%}
      <div class="toggle-box" {{ block.shopify_attributes }}{% if block.settings.open %} open{%- endif -%}>
        <figure class="toggle-box--image aspect-ratio aspect-ratio--{{ image_ratio }}" style="--ratio-percent: {{ 1 | divided_by: ratio | times: 100 }}%;">
          {%- if block.settings.image_link != blank -%}
          <a href="{{ block.settings.image_link }}">
          {%- endif -%}
          {%- if block.settings.image -%}
            {%- liquid
              assign sizes = '345x0,690x0'
            -%}
            {%- render 'responsive-image', image: block.settings.image, sizes: sizes -%}
          {%- else -%}
            <div class="thb-placeholder">
              {{ 'image' | placeholder_svg_tag: 'placeholder_svg_tag' }}
            </div>
          {%- endif -%}
          {%- if block.settings.image_link != blank -%}
          </a>
          {%- endif -%}
        </figure>
        <div class="toggle-box--content rte text-{{ text_alignment }}">
          <scroll-shadow class="toggle-box--content-inner" style="--bg-body-rgb: {{ color_bg.rgb | replace: ' ' , ',' }}">
            <div>
              {% if block.settings.text != blank %}
                {{ block.settings.text | newline_to_br }}
              {% endif %}
            </div>
          </scroll-shadow>
        </div>
        <button class="toggle-box--button">{{ block.settings.heading | default: 'Toggle' }} <span></span></button>
      </div>
    {%- endfor -%}
  </div>
</div>
